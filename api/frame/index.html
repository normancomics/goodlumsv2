const express = require('express');
const app = express();

app.use(express.json());

// API route for Farcaster Frame
app.post('/api/frame', (req, res) => {
    const { action, state } = req.body;

    console.log(`Received: action=${action}, state=${state}`);
    let newState = state;

    switch (action) {
        case 'connect_wallet':
            newState = 'wallet_connected';
            break;
        case 'mint_base':
            newState = 'minting_on_base';
            break;
        case 'mint_sanko':
            newState = 'minting_on_sanko';
            break;
        case 'view_collection':
            newState = 'viewing_collection';
            break;
    }

    res.json({ state: newState });
});

// Start server
const PORT = process.env.PORT || 2999;
app.listen(PORT, () => console.log(`API running on http://localhost:${PORT}`));